/*
 * author lpiii @losmessi
 */
(function(D){var F=D(window);$body=D("body");var K=D(document),H=D.browser.mozilla,_=D.browser.webkit,O=D.browser.safari,C=navigator.userAgent.toLowerCase().match(/ipad/i)=="ipad",N=D.browser.msie,A=N&&parseFloat(D.browser.version)<7,I=N&&parseFloat(D.browser.version)<9,L=navigator.platform.toLowerCase().indexOf("win")>-1?true:false,J,$,M=640,B=880;try{document.domain="qq.com"}catch(E){}D.fx.interval=40;$f=window.$f||{NS:{},resizeHandle:function(_){var A=$f;J=640,$=F.height();if($<1.05*J)$=Math.round(J*B/M);D(".main").height($);D(".view").each(function(A,_){D(this).css({height:$})});D(".container").css({height:$*D(".view").length});D(".view_bg img").each(function(A,_){var E=D(this).data("w"),C=D(this).data("h"),B=Math.max(J/E,$/C);D(this).css({width:B*E,height:B*C,marginLeft:-(B*E)/2,marginTop:-(B*C)/2,left:"50%",top:"50%"})})},cssInit:function(){var _=this,$="cssInit";for(var A in _)A.indexOf("Init")>0&&A!=$&&D.isFunction(_[A])&&_[A]();return},init:function(){var $=this;F.resize($.resizeHandle);$.cssInit();F.trigger("resize")},renderNav:function($){var A=this,_=D(".nav li");_.removeClass("cur").eq($).addClass("cur")},pageInit:function(){var N=this,M=D(".B_dir"),G=1,K=D(".view"),P=K.length,O,I,B=D(".container"),Q=550,H="easeInOutSine";F.bind("load",function(){setTimeout(function(){D("#view1 .load").remove();D("#view1 .tip").css({display:"block",opacity:1}).transition({opacity:1},500);__img__=null;G=0},1500)});M.bind("click",function(){var $=!M.index(this)?-1:1;O=K.index(K.filter(".cur")),I=O+$;if(!G&&I>=0&&I<P){G=1;K.eq(O).trigger("leave");K.eq(I).trigger("enter")}});K.bind("enter",function(){var A=this,_=I;D(this).stop().addClass("cur").css({zIndex:1});B.stop().transition({y:-1*I*$},Q,H,function(){setTimeout(function(){G=0},250);N.renderNav(_)})}).bind("leave",function(){var _=this;D(this).stop(true,true).removeClass("cur").css({zIndex:0}).find(".view_bg").transition({y:$*(O>I?-0.65:0.65)},Q,H,function(){D(this).css({y:0})})});D("#view2,#view3").bind("enter",function(){var _=this,A=D(_).find("ul").length-1;D(this).find("ul").each(function(B,_){var E=I>O?1:-1,C=E>0?B+1:A+1-B;D(this).stop().transition({y:$*0.5*E*C},0).transition({y:0},Q+C*250,H)})}).bind("leave",function(){var _=this,A=D(_).find("ul").length-1;D(this).find("ul").each(function(B,_){var E=O>I?1:-1,C=E>0?B+1:A+1-B;D(this).transition({y:$*0.5*E*C},Q+C*250,H)})});D("body").hammer({drag_lock_to_axis:true}).on("drag swipeup swipedown",function($){$.gesture.preventDefault();$.gesture.stopPropagation();$.stopPropagation();$.preventDefault();switch($.type){case"swipedown":M.eq(0).trigger("click");break;case"swipeup":M.eq(1).trigger("click");break}});var J=D(".view ul a"),L=D(".wrapper"),C=D(".person"),_=C.length,E="easeInOutCubic",A="linear";J.bind("click",function(){if(!G){var _=D(this).data("p");if(!C.filter("#"+_).get(0))return;G=1,_select(_),L.eq(1).stop().transition({y:-$},Q,E,function(){G=0})}});L.eq(1).hammer({drag_lock_to_axis:true}).on("drag swipeup swipedown swipeleft swiperight",function($){$.gesture.preventDefault();$.gesture.stopPropagation();$.stopPropagation();$.preventDefault();switch($.type){case"swipedown":D(this).trigger("return");break;case"swipeleft":_slider(1);break;case"swiperight":_slider(-1);break;default:break}}).bind("return",function(){if(!G){G=1;L.eq(1).stop().transition({y:-0},Q,E,function(){G=0})}}).find(".close").bind("click",function(){L.eq(1).trigger("return")}),_slider=function(A){if(!G){G=1;var B=C.index(C.filter(".cur")),$=(__tar=B+A)<0?_-1:__tar>=_?0:__tar;C.eq($).stop().transition({x:A<0?-640:640},0).css({display:"block",zIndex:1}).transition({x:0},Q,E,function(){C.eq(B).css({display:"none"}).removeClass("cur");D(this).addClass("cur").css({zIndex:0});G=0})}},_select=function($){C.hide().removeClass("cur").filter("#"+$).addClass("cur").css({display:"block"}).transition({x:0},0)}},slideClickHandler:function(G,F,_,E,H,C){var B=this;if(!D(G).hasClass("current")&&(!C||!C.state)){var $=D(F).index(D(F+".current")),A=D(F).index(D(G));C.state=true;B.slideRender(D(_),$,A,E,H,C?function(){C.state=false}:null);D(F).eq($).removeClass("current");D(F).eq(A).addClass("current")}},slideLeftRightHanler:function(E,C,B){var A=D(B).size(),F=D(C).index(E)==0?-1:1,$=D(B).index(D(B+".current")),_=$+F<0?A-1:$+F>=A?0:$+F;D(B).eq(_).trigger("click",($+F<0||$+F>=A)?true:false)},slideRender:function(E,$,A,B,_,C){var F=D(E);F.eq(A).stop(true,false).css({"display":"block","left":!!_?($>A?"100%":"-100%"):($>A?"-100%":"100%"),"z-index":1}).animate({left:"0%"},B,"easeInOutSine",C);F.eq(A).trigger("slideIn");F.eq($).stop(true,false).css({"display":"block","z-index":0}).animate({left:!!_?($>A?"-100%":"100%"):($>A?"100%":"-100%")},B+50,"easeInOutSine",function(){D(this).hide();D(this).trigger("slideOut")});F.eq($).removeClass("current");F.eq(A).addClass("current")},fadeLeftRightHandler:function(E,C,_){var B=D(_nav).size(),F=D(C).index(E)==0?-1:1,$=D(_nav).index(D(_nav+".current")),A=$+F<0?B-1:$+F>=B?0:$+F;_.eq($).fadeOut(350,function(){_.eq(A).fadeIn(350)})},TPL:function($,_){return $.replace(/\{([\w\.]*)\}/g,function(A,D){var B=D.split("."),$=_[B.shift()];for(var E=0,C=B.length;E<C;E++)$=$[B[E]];return(typeof $!=="undefined"&&$!==null)?$:""})},cssCreator:function(_,$){var A={};A[_]=A["-moz-"+_]=A["-webkit-"+_]=A["-ms-"+_]=A["-o-"+_]=$;return A},pxToInt:function($){return $.indexOf("px")>-1?Math.round(parseFloat($.split("px")[0])):$},shuffleArray:function($){for(var _,B,A=$.length;A;_=parseInt(Math.random()*A),B=$[--A],$[A]=$[_],$[_]=B);return $},sizeOf:function(_){var $=0;for(var A in _)$++;return $},objTostr:function(B,A,$){var _="";A=!!A?A:"";var C=!!$?"":" ";for(var D in B)_+=(A+D+C);return _},objTostrP:function(C,B,A,$){var _="";A=!!A?A:"";var D=!!$?"":" ";for(var E in C)_+=(A+C[E][B]+D);return _},is:function($,A){var _=Object.prototype.toString.call(A).slice(8,-1).toLowerCase();return A!==undefined&&A!==null&&_===$.toLowerCase()},isFunction:function($){return this.is("function",$)},isObject:function($){return this.is("object",$)},isString:function($){return this.is("string",$)},isArray:function($){return this.is("array",$)},isBoolean:function($){return this.is("boolean",$)},isDate:function($){return this.is("date",$)},isNumber:function($){return this.is("number",$)},isUndefined:function($){return $===undefined},isNull:function($){return $===null},isEmptyObject:function($){if(this.isObject($)){for(var _ in $)return false;return true}else return false},isEmptyArray:function($){return this.isArray($)&&$.length==0},isNotEmptyArray:function($){return this.isArray($)&&$.length>0}};function G($){if(window.console&&window.console.log)window.console.log($);else if(window.opera&&window.opera.postError)window.opera.postError($)}D().ready(function($){$f.init()})}).call(window,jQuery);